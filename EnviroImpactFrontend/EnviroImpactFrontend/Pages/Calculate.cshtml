@page
@model EnviroImpactFrontend.Pages.CalculateModel
@{
    ViewData["Title"] = "Calculate";
}

<div class="main-content">
    <div class="calculate-row">
        <!-- Input Panel as a card -->
        <div class="card shadow p-4" style="background-color: #f2f2f2; width: 400px; z-index: 2;">
            <h3 class="fw-bold">Calculate your impact</h3>
            <p class="text-muted small">Estimate your energy use, emissions, and cost — advanced inputs are optional.</p>

            <form id="impactForm">
                <div class="mb-3">
                    <label for="location" class="form-label" data-bs-toggle="tooltip"
                           title="Choose the region where the facility is located. This affects electricity pricing and emissions.">
                        1. Region
                    </label>
                    <select id="location" class="form-select">
                        <option value="">-- Loading regions... --</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="facilityType" class="form-label">
                        2. Facility Type
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Select the kind of facility you're assessing. This determines the baseline electricity use."></i>
                    </label>
                    <select id="facilityType" class="form-select">
                        <option value="">-- Select Facility type --</option>
                        <option>data_center</option>
                        <option>factory</option>
                        <option>hospital</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="size" class="form-label">
                        3. Facility Size
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Pick the size that most closely matches your facility. Larger sizes use more energy."></i>
                    </label>
                    <select id="size" class="form-select">
                        <option value="">-- Select Size --</option>
                        <option>small</option>
                        <option>medium</option>
                        <option>large</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="usagePattern" class="form-label">
                        4. Usage Pattern
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Choose how the facility typically uses electricity — steadily, with peaks, or irregularly."></i>
                    </label>
                    <select id="usagePattern" class="form-select">
                        <option value="">-- Select Usage Pattern --</option>
                        <option>constant</option>
                        <option>peak</option>
                        <option>intermittent</option>
                    </select>
                </div>

                <!-- Simple/Advanced toggle -->
          
                <p class="text-center mt-3 small text-muted">
                    <a href="#" id="simpleToggle" class="toggle-link active">Simple</a> |
                    <a href="#" id="advancedToggle" class="toggle-link">Advanced</a>
                </p>


                <!-- Advanced Inputs (hidden by default) -->
                <div id="advancedFields" style="display:none;">
                    <div class="mb-3">
                        <label for="customKwh" class="form-label">
                            Custom kWh
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Override the default kWh estimate with your own total."></i>
                        </label>
                        <input type="number" class="form-control" id="customKwh" />
                    </div>
                    <div class="mb-3">
                        <label for="customEmission" class="form-label">
                            Custom CO₂ Factor (kg/kWh)
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Manually enter the CO₂ factor for your region (in kg/kWh)."></i>
                        </label>
                        <input type="number" class="form-control" id="customEmission" step="0.0001" />
                    </div>
                    <div class="mb-3">
                        <label for="customPrice" class="form-label">
                            Custom Price (NOK/kWh)
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Set your own electricity price (in NOK/kWh) instead of using the average."></i>
                        </label>
                        <input type="number" class="form-control" id="customPrice" step="0.01" />
                    </div>
                </div>

                <div class="d-grid mt-4">
                    <button type="submit" class="btn btn-primary btn-lg">Calculate</button>
                </div>
            </form>
        </div>

        <!-- Output Panel -->
        <div id="resultPanel" class="d-flex align-items-center">
            <div class="card result-card inactive" id="resultCard">
                <h2 class="fw-bold">Facility Results</h2>

                <!-- Combined row: Values + Charts -->
                <div class="row align-items-stretch">
                    <!-- Usage -->
                    <div class="col d-flex flex-column justify-content-between">
                        <div>
                            <h5>
                                Usage per year
                                <i id="usageInfo" class="bi bi-info-circle ms-2 text-secondary" data-bs-toggle="tooltip" title=""></i>
                            </h5>
                            <p class="display-6 text-success"><strong id="resultKwh">–</strong> kWh</p>
                            <p class="small text-muted">Total estimated energy use for your facility, based on selected region, size, and usage pattern.</p>
                        </div>
                        <div class="mt-3">
                            <canvas id="benchmarkChart" width="300" height="180" style="max-width: 100%;"></canvas>
                        </div>
                    </div>

                    <!-- Emissions -->
                    <div class="col d-flex flex-column justify-content-between">
                        <div>
                            <h5>
                                Emissions per year
                                <i id="emissionsInfo" class="bi bi-info-circle ms-2 text-secondary" data-bs-toggle="tooltip" title=""></i>
                            </h5>
                            <p class="display-6 text-info"><strong id="resultCo2">–</strong> kg CO₂</p>
                            <p class="small text-muted">Estimated annual CO₂ emissions, calculated from your facility’s energy use and local emission factors.</p>
                        </div>
                        <div class="mt-3">
                            <canvas id="co2Chart" width="300" height="180" style="max-width: 100%;"></canvas>
                        </div>
                    </div>

                    <!-- Cost -->
                    <div class="col d-flex flex-column justify-content-between">
                        <div>
                            <h5>
                                Cost per year
                                <i id="costPerYearInfo" class="bi bi-info-circle ms-2 text-secondary" data-bs-toggle="tooltip" title=""></i>
                            </h5>
                            <p class="display-6 text-warning"><strong id="resultCost">–</strong> NOK</p>
                            <p class="small text-muted">Estimated annual energy cost based on current electricity prices and selected facility characteristics.</p>
                        </div>
                        <div class="mt-3">
                            <canvas id="costChart" width="300" height="180" style="max-width: 100%;"></canvas>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
