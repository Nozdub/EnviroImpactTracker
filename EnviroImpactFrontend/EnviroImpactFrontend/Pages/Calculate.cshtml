@page
@model EnviroImpactFrontend.Pages.CalculateModel
@{
    ViewData["Title"] = "Calculate";
}

<div class="container-fluid px-5">
    <div class="d-flex flex-row align-items-start mt-5 position-relative" style="min-height: 600px;">
        <!-- Input Panel as a card -->
        <div class="card shadow p-4" style="background-color: #f2f2f2; width: 450px; z-index: 2;">
            <h3 class="fw-bold">Calculate your impact</h3>
            <p class="text-muted small">Estimate your energy use, emissions, and cost — advanced inputs are optional.</p>

            <form id="impactForm">
                <div class="mb-3">
                    <label for="location" class="form-label" data-bs-toggle="tooltip"
                           title="Choose the region where the facility is located. This affects electricity pricing and emissions.">
                        1. Region
                    </label>
                    <select id="location" class="form-select">
                        <option value="">-- Loading regions... --</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="facilityType" class="form-label">
                        2. Facility Type
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Select the kind of facility you're assessing. This determines the baseline electricity use."></i>
                    </label>
                    <select id="facilityType" class="form-select">
                        <option value="">-- Select Facility type --</option>
                        <option>data_center</option>
                        <option>factory</option>
                        <option>hospital</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="size" class="form-label">
                        3. Facility Size
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Pick the size that most closely matches your facility. Larger sizes use more energy."></i>
                    </label>
                    <select id="size" class="form-select">
                        <option value="">-- Select Size --</option>
                        <option>small</option>
                        <option>medium</option>
                        <option>large</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="machineCount" class="form-label">
                        4. Machine Count
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="How many machines or devices are typically running in the facility?"></i>
                    </label>
                    <input type="number" class="form-control" id="machineCount" />
                </div>

                <div class="mb-3">
                    <label for="usagePattern" class="form-label">
                        5. Usage Pattern
                        <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Choose how the facility typically uses electricity — steadily, with peaks, or irregularly."></i>
                    </label>
                    <select id="usagePattern" class="form-select">
                        <option value="">-- Select Usage Pattern --</option>
                        <option>constant</option>
                        <option>peak</option>
                        <option>intermittent</option>
                    </select>
                </div>

                <!-- Simple/Advanced toggle -->
                <p class="text-center mt-3 small text-muted">
                    <span id="simpleLabel" class="text-primary text-decoration-underline" role="button">Simple</span> |
                    <span id="advancedLabel" class="text-muted text-decoration-underline" role="button">Advanced</span>
                </p>

                <!-- Advanced Inputs (hidden by default) -->
                <div id="advancedFields" style="display:none;">
                    <div class="mb-3">
                        <label for="customKwh" class="form-label">
                            Custom kWh
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Override the default kWh estimate with your own total."></i>
                        </label>
                        <input type="number" class="form-control" id="customKwh" />
                    </div>
                    <div class="mb-3">
                        <label for="customEmission" class="form-label">
                            Custom CO₂ Factor (kg/kWh)
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Manually enter the CO₂ factor for your region (in kg/kWh)."></i>
                        </label>
                        <input type="number" class="form-control" id="customEmission" step="0.0001" />
                    </div>
                    <div class="mb-3">
                        <label for="customPrice" class="form-label">
                            Custom Price (NOK/kWh)
                            <i class="bi bi-info-circle ms-1" data-bs-toggle="tooltip" title="Optional: Set your own electricity price (in NOK/kWh) instead of using the average."></i>
                        </label>
                        <input type="number" class="form-control" id="customPrice" step="0.01" />
                    </div>
                </div>

                <div class="d-grid mt-4">
                    <button type="submit" class="btn btn-primary btn-lg">Calculate</button>
                </div>
            </form>
        </div>

        <!-- Output Panel -->
        <div id="resultPanel" class="d-flex align-items-center" style="height: 70%;">
            <div class="card result-card inactive" id="resultCard">
                <h2 class="fw-bold">Facility Results</h2>
                <div class="mt-4">
                    <h5>Usage per year</h5>
                    <p class="display-6 text-success"><strong id="resultKwh">–</strong> kWh/year</p>
                    <p class="text-muted small">Calculated based on location, machine count, size, and usage pattern.</p>
                </div>
                <div class="mt-4">
                    <h5>Emissions per year</h5>
                    <p class="display-6 text-info"><strong id="resultCo2">–</strong> kg CO₂</p>
                    <p class="text-muted small">Based on energy use and emission factor for your region.</p>
                </div>
                <div class="mt-4">
                    <h5>Cost per year</h5>
                    <p class="display-6 text-warning"><strong id="resultCost">–</strong> NOK/year</p>
                    <p class="text-muted small">Calculated using current or custom energy prices.</p>
                </div>
            </div>
        </div>
    </div>
</div>
